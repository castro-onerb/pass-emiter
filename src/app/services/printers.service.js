async function setupPrinters() {
  const printersField = document.getElementById('printers');
  if (!printersField) {
    return;
  }

  try {
    const printers = await window.printerAPI.getPrinters();

    if (!printers || printers.length === 0) {
      window.dispatchEvent(new CustomEvent('modal-show', {
        detail: {
          title: 'Atenção',
          message: 'Nenhuma impressora foi encontrada.',
        },
      }));
      return;
    }

    printers.forEach(printer => {
      const option = document.createElement('option');
      option.value = printer.name;
      option.textContent = printer.name;
      printersField.appendChild(option);
    });

    const defaultPrinter = await window.printerAPI.getDefault();
    if (defaultPrinter) {
      printersField.value = defaultPrinter;
    }

  } catch (error) {
    console.error('Erro ao carregar impressoras:', error);
    window.dispatchEvent(new CustomEvent('modal-show', {
      detail: {
        title: 'Erro',
        message: 'Não foi possível carregar as impressoras.',
      },
    }));
  }
}

async function saveDefaultPrinter() {
  const printersField = document.getElementById('printers');
  const selectedPrinter = printersField.value;

  try {
    const res = await window.printerAPI.setDefault(selectedPrinter);
    if (res.success) {
      window.dispatchEvent(new CustomEvent('modal-show', {
        detail: {
          title: `Impressora "${selectedPrinter}" salva como padrão.`,
        },
      }));
    }
  } catch (error) {
    console.error('Erro ao salvar impressora padrão:', error);
    window.dispatchEvent(new CustomEvent('modal-show', {
      detail: {
        title: 'Erro ao salvar impressora',
        message: error.message || 'Algo deu errado ao salvar a impressora padrão.',
      },
    }));
  }
}

export function generateTicketHTML({ code, type, origin, qrcodeBase64 }) {
  const date = new Date().toLocaleString('pt-BR');

  return `
    <!DOCTYPE html>
    <html lang="pt-br">
    <head>
      <meta charset="UTF-8">
      <style>
        @page {
          width: 65mm;
          height: 200mm;
          margin: 0;
        }
        * {
          box-sizing: border-box;
        }
        html, body {
          margin: 0;
          padding: 0;
          width: 65mm;
          height: 200mm;
        }
        body { font-family: Arial, sans-serif; text-align: center; }
        h1 { font-size: 32px; margin: 0; }
        p { margin: 4px 0; }
        .marketing-deovita { display: flex; flex-direction: column; gap: 6px; align-items: center; margin-block: 10px; }
        img.qrcode { width: 100px; margin-top: 10px; }
        .ticket {
          width: 65mm;
          height: 200mm;
          box-sizing: border-box;
          border: 1px dashed #ccc;
        }
      </style>
    </head>
    <body>
      <div class="ticket">
        <img width="120" style="margin-inline: auto" alt="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQwIiBoZWlnaHQ9Ijk2IiB2aWV3Qm94PSIwIDAgMjQwIDk2IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwMy4wNDkgODEuNjA3SDEyMC44MTJWNzUuODEwNUgxMDkuNTQ1VjUyLjgzMDVIMTAzLjA0OUwxMDMuMDQ5IDgxLjYwN1pNMTMyLjc5IDgyLjE0MTNDMTM1LjcwOSA4Mi4xNDEzIDEzNy43NjUgODAuNjYxMSAxMzguNTg4IDc5LjIyMjhIMTM4LjkxN1Y4MS42MDdIMTQ0Ljk2MVY1OS45MDEzSDEzOC41ODhWNzIuMDY5NUMxMzguNTg4IDc0LjM3MTYgMTM3LjEwNyA3Ni4yMjE1IDEzNC44ODcgNzYuMjIxNUMxMzIuNzA4IDc2LjIyMTUgMTMxLjM5MiA3NC42NTk1IDEzMS4zOTIgNzIuMzk4VjU5LjkwMTFIMTI1LjAxOVY3NC4zNzE0QzEyNS4wMTkgNzguODkzMyAxMjcuOTc5IDgyLjE0MTMgMTMyLjc5IDgyLjE0MTNaTTE2MC41NTggODEuNjA3SDE2NC45NThWNzYuMzQ0OEgxNjIuMTYyQzE2MC4yNyA3Ni4zNDQ4IDE1OS4zNjUgNzUuMzU4MyAxNTkuMzY1IDczLjc1NTNWNjQuODc1NkgxNjUuMDRWNTkuOTAxNkgxNTkuMzY1VjU0LjAyMjZIMTUzLjMyMVY1OC4wMTA0QzE1My4zMjEgNTkuMTYxNyAxNTIuNzA0IDU5Ljk0MjggMTUxLjU1MyA1OS45NDI4SDE0OS40OTdWNjQuODc1NkgxNTIuOTkyVjc0LjA4MzdDMTUyLjk5MiA3OC44NTI1IDE1NS44MjkgODEuNjA3IDE2MC41NTggODEuNjA3Wk0xNjkuNDExIDgxLjYwN0gxODcuMjU3Vjc2LjE4MDVIMTc3LjY3NlY3NS44NTE4TDE4Ny4wNTEgNjUuMTYzMVY1OS45MDE2SDE2OS43NFY2NS4xNjMxSDE3OC43ODZWNjUuNDkyNEwxNjkuNDExIDc1Ljk3NTFMMTY5LjQxMSA4MS42MDdaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEwMi4zMTMgNDQuODc0OUgxMDguOTc0TDExMC42NiAzOS43Nzc1SDEyMS42OEwxMjMuNDA3IDQ0Ljg3NDlIMTMwLjMxNUwxMjAuNDA1IDE2LjA5ODRIMTEyLjA5OUwxMDIuMzEzIDQ0Ljg3NDlaTTExMi40MjggMzMuOTgwNkwxMTYuMDA2IDIzLjI1MTVIMTE2LjM3NUwxMTkuOTEyIDMzLjk4MDZIMTEyLjQyOFpNMTQyLjA4NyA0NS40MDkyQzE0NS42NjUgNDUuNDA5MiAxNDcuNDc0IDQzLjM5NSAxNDguMDkxIDQyLjQwODVIMTQ4LjQyVjQ0Ljg3NDlIMTU0Ljc1MlYxNC4wNDNIMTQ4LjM3OFYyNS42MzU3SDE0OC4wNDlDMTQ3LjMwOSAyNC40ODQ4IDE0NS4zMzUgMjIuNjM1IDE0MS45MjMgMjIuNjM1QzEzNi4wODQgMjIuNjM1IDEzMi4wNTUgMjcuMzIxMiAxMzIuMDU1IDM0LjE0NTRDMTMyLjA1NSA0MC45NjkzIDEzNi4xMjUgNDUuNDA5MiAxNDIuMDg3IDQ1LjQwOTJaTTE0My41MjYgMzkuNjU0QzE0MC41MjUgMzkuNjU0IDEzOC41MSAzNy4zOTI5IDEzOC41MSAzNC4wMjI1QzEzOC41MSAzMC42OTIgMTQwLjUyNSAyOC4zOTA0IDE0My40ODYgMjguMzkwNEMxNDYuNDA1IDI4LjM5MDQgMTQ4LjUwMiAzMC41Njg5IDE0OC41MDIgMzQuMDIyNUMxNDguNTAyIDM3LjIyODggMTQ2LjU2OSAzOS42NTQgMTQzLjUyNiAzOS42NTRaTTE3MC41OTUgNDUuNDA5MkMxNzcuNTg1IDQ1LjQwOTIgMTgyLjMxNCA0MC40MzQ4IDE4Mi4zMTQgMzQuMDIyM0MxODIuMzE0IDI3LjYwODYgMTc3LjU4NSAyMi42MzUgMTcwLjYzNiAyMi42MzVDMTYzLjYwNSAyMi42MzUgMTU4LjkxOCAyNy42MDg2IDE1OC45MTggMzQuMDIyM0MxNTguOTE4IDQwLjQzNDggMTYzLjY0NiA0NS40MDkyIDE3MC41OTUgNDUuNDA5MlpNMTcwLjU5NSAzOS42NTRDMTY3LjU5NCAzOS42NTQgMTY1LjM3MyAzNy4zNTE3IDE2NS4zNzMgMzQuMDIyNUMxNjUuMzczIDMwLjczMzMgMTY3LjU5NCAyOC4zOTA0IDE3MC41OTUgMjguMzkwNEMxNzMuNjM4IDI4LjM5MDQgMTc1Ljg1OCAzMC43MzMzIDE3NS44NTggMzQuMDIyNUMxNzUuODU4IDM3LjMxMTEgMTczLjYzOCAzOS42NTQgMTcwLjU5NSAzOS42NTRaTTE5My42MzQgNDQuODc0OUgxOTUuODE0VjM5LjI4NEgxOTUuMDMyQzE5My44ODEgMzkuMjg0IDE5My4yMjMgMzguNjI2MiAxOTMuMjIzIDM3LjMxMTFWMTQuMDQzMkgxODYuODVWMzguMDUwOUMxODYuODUgNDIuMjg1NiAxODkuMjc2IDQ0Ljg3NDkgMTkzLjYzNCA0NC44NzQ5Wk0yMDEuOTEyIDQ0Ljg3NDlIMjA4LjI4NVYyOC4xNDM2SDIxMy42NzJWMjMuMTY5NUgyMDguMjAzVjIyLjA1OTJDMjA4LjIwMyAyMC40NTYyIDIwOS4xMDcgMTkuMzA1NCAyMTEuMTIyIDE5LjMwNTRIMjEzLjUwN1YxNC4wNDMySDIxMC4zODJDMjA1LjQ0OCAxNC4wNDMyIDIwMi4wNzYgMTcuMDAzMSAyMDIuMDc2IDIxLjc3MThWMjMuMTY5NUgxOTguMzc1VjI4LjE0MzZIMjAxLjkxMkwyMDEuOTEyIDQ0Ljg3NDlaTTIyOC4yODEgNDUuNDA5MkMyMzUuMjcxIDQ1LjQwOTIgMjQwIDQwLjQzNDggMjQwIDM0LjAyMjNDMjQwIDI3LjYwODYgMjM1LjI3MiAyMi42MzUgMjI4LjMyMiAyMi42MzVDMjIxLjI5MSAyMi42MzUgMjE2LjYwMyAyNy42MDg2IDIxNi42MDMgMzQuMDIyM0MyMTYuNjAzIDQwLjQzNDggMjIxLjMzMiA0NS40MDkyIDIyOC4yODEgNDUuNDA5MlpNMjI4LjI4MSAzOS42NTRDMjI1LjI4IDM5LjY1NCAyMjMuMDU5IDM3LjM1MTcgMjIzLjA1OSAzNC4wMjI1QzIyMy4wNTkgMzAuNzMzMyAyMjUuMjggMjguMzkwNCAyMjguMjgxIDI4LjM5MDRDMjMxLjMyNCAyOC4zOTA0IDIzMy41NDQgMzAuNzMzMyAyMzMuNTQ0IDM0LjAyMjVDMjMzLjU0NCAzNy4zMTExIDIzMS4zMjQgMzkuNjU0IDIyOC4yODEgMzkuNjU0WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MC41NDM5IDE0LjY2MTNDMTguMjUzOCAxNC44Mzk4IDAuMjE1Nzg5IDMyLjg1MDYgMCA1NS4xMjZIMTQuNjQ2MUMxNC44NTk5IDQwLjkzNyAyNi4zNDI2IDI5LjQ4MDggNDAuNTQzOSAyOS4zMDM5VjE0LjY2MTNaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMCA1NS4xMjZIMTQuNjQ2MUMxNC44NTk5IDQwLjkzNyAyNi4zNDI2IDI5LjQ4MDggNDAuNTQzOSAyOS4zMDM5VjE0LjY2MTNDMTguMjUzOCAxNC44Mzk4IDAuMjE1Nzg5IDMyLjg1MDYgMCA1NS4xMjZaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTcuMzUwNzQgNTUuMDY5OEM3LjUyOTI0IDc3LjM1NDcgMjUuNTQzOSA5NS4zODgyIDQ3LjgyNTMgOTUuNjAzNVY4MC45NjE2QzMzLjYzMjcgODAuNzQ3MSAyMi4xNzQgNjkuMjY3OCAyMS45OTY4IDU1LjA3TDcuMzUwNzQgNTUuMDY5OFoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0yMS45OTY4IDU1LjA3TDcuMzUwNzQgNTUuMDY5OEM3LjUyOTI0IDc3LjM1NDcgMjUuNTQzOSA5NS4zODgyIDQ3LjgyNTMgOTUuNjAzNVY4MC45NjE2QzMzLjYzMjcgODAuNzQ3MSAyMi4xNzQgNjkuMjY3OCAyMS45OTY4IDU1LjA3WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00Ny44NDIzIDgwLjkyOTVDNzAuMTMyNCA4MC43NTExIDg4LjE3MDIgNjIuNzQwMyA4OC4zODYgNDAuNDY0OUg3My43Mzk0QzczLjUyNjEgNTQuNjUzOSA2Mi4wNDM0IDY2LjExMDEgNDcuODQyMyA2Ni4yODdWODAuOTI5NVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik04OC4zODYgNDAuNDY0OUg3My43Mzk0QzczLjUyNjEgNTQuNjUzOSA2Mi4wNDM0IDY2LjExMDEgNDcuODQyMyA2Ni4yODdWODAuOTI5NUM3MC4xMzI0IDgwLjc1MTEgODguMTcwMiA2Mi43NDAzIDg4LjM4NiA0MC40NjQ5WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00MC41MTg3IDBDNjIuODA4OCAwLjE3ODQ1OCA4MC44NDY4IDE4LjE4OTIgODEuMDYyNiA0MC40NjQ5SDY2LjQxNjVDNjYuMjAyMyAyNi4yNzU2IDU0LjcyIDE0LjgxOTkgNDAuNTE4NyAxNC42NDI2VjBaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNNjYuNDE2NSA0MC40NjQ5SDgxLjA2MjZDODAuODQ3MSAxOC4xOTc2IDYyLjgyMyAwLjE5MjgyIDQwLjU0NTcgMC4wMDAyNDQ4ODFMNDAuNTE4NyAwVjE0LjY0MjZDNTQuNzIgMTQuODE5OSA2Ni4yMDIzIDI2LjI3NTYgNjYuNDE2NSA0MC40NjQ5WiIgZmlsbD0iYmxhY2siLz4KPC9zdmc+Cg==" />
        <h1>Senha: ${code}</h1>
        <p>Data: ${date}</p>
        <p>Tipo: ${type}</p>
        <p>${origin}</p>
        <div style="height: 10mm;">.</div>
        <p>ATENÇÃO: Consultas com especialistas por apenas</p>
        <p>R$ 40,00 aqui no Adolfo Lutz.</p>
        <div class="marketing-deovita">
          <img width="120" style="margin-inline: auto" alt="" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTUwIiBoZWlnaHQ9IjQzIiB2aWV3Qm94PSIwIDAgMTUwIDQzIiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8cGF0aCBkPSJNMC4wNTE0Nzc5IDIyLjU4OTVDLTAuODA4NzYyIDEyLjcxNzEgOS4yMzE5MSA0Ljg5OTY4IDIxLjIxOTQgNi4xMzc4NEMyMS41MTEgNi4xNjc3NCAyMS41ODIyIDYuNjI0NSAyMS4yOTM2IDYuNjc2MjlDMTEuNTAyMSA4LjQzNTgxIDguNDYzNTIgMjMuMDE2MiAxLjM0Nzk0IDIzLjQ1ODFDMC43MTU3NCAyMy40OTc1IDAuMTA2NDU1IDIzLjIyMDUgMC4wNTE0Nzc5IDIyLjU4OTVaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMC4wNTE0Nzc5IDIyLjU4OTVDMC4wNzU5NDk2IDIyLjg3MDEgMC4yMTM2OTYgMjMuMDc2OCAwLjQxMDQ4NyAyMy4yMjA1QzEuODA5NzEgMjQuMDI4MSA0LjE4MTM3IDIxLjY4OTkgNS43NTA1NSAxNi44MDlDOC4wNTIxMSA5LjY0OTI0IDE1LjA5NTggNi4yOTIgMjEuMjE5NCA2LjEzNzg0QzkuMjMxOTEgNC44OTk2OCAtMC44MDg3NjIgMTIuNzE3MSAwLjA1MTQ3NzkgMjIuNTg5NVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0yMi41ODk3IDQyLjk0NjRDMTIuNzE3MyA0My44MDY3IDQuODk5ODggMzMuNzY1OSA2LjEzODA0IDIxLjc3ODRDNi4xNjgwNyAyMS40ODY5IDYuNjI0NTYgMjEuNDE1OCA2LjY3NjM1IDIxLjcwNDNDOC40MzU4OCAzMS40OTU3IDIzLjAxNjQgMzQuNTM0MyAyMy40NTgzIDQxLjY0OTlDMjMuNDk3NiA0Mi4yODIxIDIzLjIyMDcgNDIuODkxNCAyMi41ODk3IDQyLjk0NjRaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMjIuNTg5NyA0Mi45NDY0QzIyLjg3MDEgNDIuOTIxOSAyMy4wNzY4IDQyLjc4NCAyMy4yMjA3IDQyLjU4NzJDMjQuMDI4MyA0MS4xODggMjEuNjkwMSAzOC44MTYzIDE2LjgwOTIgMzcuMjQ3M0M5LjY0OTQzIDM0Ljk0NTYgNi4yOTIxOSAyNy45MDIgNi4xMzgwNCAyMS43Nzg0QzQuODk5ODggMzMuNzY1OSAxMi43MTczIDQzLjgwNjcgMjIuNTg5NyA0Mi45NDY0WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTQyLjk0NiAyMC40MDc4QzQzLjgwNjQgMzAuMjgwNCAzMy43NjU2IDM4LjA5NzggMjEuNzc4MSAzNi44NTk2QzIxLjQ4NjUgMzYuODI5NiAyMS40MTU0IDM2LjM3MyAyMS43MDM5IDM2LjMyMTJDMzEuNDk1NSAzNC41NjE3IDM0LjUzNCAxOS45ODEzIDQxLjY0OTYgMTkuNTM5MkM0Mi4yODE4IDE5LjUgNDIuODkxIDE5Ljc3NjkgNDIuOTQ2IDIwLjQwNzhaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNNDIuOTQ2IDIwLjQwNzhDNDIuOTIxNSAyMC4xMjczIDQyLjc4MzggMTkuOTIwNyA0Mi41ODY4IDE5Ljc3NjhDNDEuMTg3NCAxOC45NjkyIDM4LjgxNTcgMjEuMzA3NCAzNy4yNDY4IDI2LjE4ODNDMzQuOTQ1IDMzLjM0ODEgMjcuOTAxNyAzNi43MDU1IDIxLjc3ODEgMzYuODU5NkMzMy43NjU2IDM4LjA5NzggNDMuODA2NCAzMC4yODA0IDQyLjk0NiAyMC40MDc4WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTIwLjQwOCAwLjA1MTQ4MjlDMzAuMjgwNCAtMC44MDg3NTcgMzguMDk3OCA5LjIzMTkxIDM2Ljg1OTcgMjEuMjE5NEMzNi44Mjk4IDIxLjUxMSAzNi4zNzMgMjEuNTgyMiAzNi4zMjE0IDIxLjI5MzdDMzQuNTYxNyAxMS41MDIxIDE5Ljk4MTMgOC40NjM0NiAxOS41Mzk0IDEuMzQ4MDhDMTkuNTAwMSAwLjcxNTc0NSAxOS43NzcgMC4xMDY0NiAyMC40MDggMC4wNTE0ODI5WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTIwLjQwOCAwLjA1MTQ4MjlDMjAuMTI3NCAwLjA3NTk1NDYgMTkuOTIwNiAwLjIxMzU2NiAxOS43NzY4IDAuNDEwNDkyQzE4Ljk2OTEgMS44MDk3MiAyMS4zMDc1IDQuMTgxMzggMjYuMTg4NCA1Ljc1MDU1QzMzLjM0ODEgOC4wNTIxMiAzNi43MDU0IDE1LjA5NiAzNi44NTk3IDIxLjIxOTRDMzguMDk3OCA5LjIzMTkxIDMwLjI4MDQgLTAuODA4NzU3IDIwLjQwOCAwLjA1MTQ4MjlaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNNzYuOTk5MSAyMC40NzI5SDcyLjQ0OTVWMTkuMzM1NEM3Mi40NDk1IDE4LjcwNzUgNzIuOTU4NiAxOC4xOTgyIDczLjU4NjggMTguMTk4Mkg3NS44NjE2Qzc2LjQ4OTggMTguMTk4MiA3Ni45OTkxIDE4LjcwNzUgNzYuOTk5MSAxOS4zMzU0VjIwLjQ3MjlaTTc2Ljk5OTEgMTMuNjQ4NUg3Mi40NDk1QzY5LjkzNjcgMTMuNjQ4NSA2Ny44OTk5IDE1LjY4NTQgNjcuODk5OSAxOC4xOTgyVjI3LjI5NzNDNjcuODk5OSAyOS44MDk5IDY5LjkzNjcgMzEuODQ2NyA3Mi40NDk1IDMxLjg0NjdIODAuNDExMlYyNy4yOTczSDczLjU4NjhDNzIuOTU4NiAyNy4yOTczIDcyLjQ0OTUgMjYuNzg4IDcyLjQ0OTUgMjYuMTU5OFYyNS4wMjIzSDgxLjU0ODVWMTguMTk4MkM4MS41NDg1IDE1LjY4NTMgNzkuNTExNyAxMy42NDg1IDc2Ljk5OTEgMTMuNjQ4NVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik01OC44MDA3IDBINDkuNzAxNlY0LjUwMjlINTguNzQyMkM1OS45OTg2IDQuNTAyOSA2MS4wMTcgNS41MjEyNSA2MS4wMTcgNi43Nzc1NVYyNC45NzU4QzYxLjAxNyAyNi4yMzIyIDU5Ljk5ODYgMjcuMjUwNiA1OC43NDIyIDI3LjI1MDZINTQuMTkyN1Y2LjgyNDM4SDQ5LjcwMTVWMzEuODQ2OUg1OC44MDA3QzYyLjU2OTUgMzEuODQ2OSA2NS42MjQ5IDI4Ljc5MTUgNjUuNjI0OSAyNS4wMjI1VjYuODI0NDRDNjUuNjI0OSAzLjA1NTU5IDYyLjU2OTYgMCA1OC44MDA3IDBaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNNDkuNzM1MiA0MC44OTg0QzUwLjA0MzQgNDEuMDc4MyA1MC40ODUzIDQxLjE5NjUgNTAuOTY1OCA0MS4xOTY1QzUyLjAwODkgNDEuMTk2NSA1Mi42MDc1IDQwLjY1NDQgNTIuNjA3NSAzOS44ODM1QzUyLjYwNzUgMzkuMjMxIDUyLjIxNyAzOC44NTA4IDUxLjQ1NjQgMzguNTYwNEM1MC44ODYxIDM4LjM0MiA1MC42MjE1IDM4LjE4MDMgNTAuNjIxNSAzNy44MTU0QzUwLjYyMTUgMzcuNDg5MSA1MC44ODYxIDM3LjIxOTQgNTEuMzU2MiAzNy4yMTk0QzUxLjc2NDcgMzcuMjE5NCA1Mi4wODA4IDM3LjM2MzIgNTIuMjUyOSAzNy40NzEyTDUyLjQ1MzQgMzYuODkzMUM1Mi4yMDkyIDM2Ljc0NjcgNTEuODE4OCAzNi42MjA4IDUxLjM3NDMgMzYuNjIwOEM1MC40MzE0IDM2LjYyMDggNDkuODYxMSAzNy4yMDE1IDQ5Ljg2MTEgMzcuOTA3OUM0OS44NjExIDM4LjQzMjEgNTAuMjMzNiAzOC44Njg4IDUxLjAyMjMgMzkuMTQ4OEM1MS42MTA2IDM5LjM2NzIgNTEuODM2OCAzOS41NzUyIDUxLjgzNjggMzkuOTU1NUM1MS44MzY4IDQwLjMxNzggNTEuNTY0NSA0MC42MDgyIDUwLjk4MzggNDAuNjA4MkM1MC41ODU2IDQwLjYwODIgNTAuMTY5NCA0MC40NDM3IDQ5LjkzMzIgNDAuMjg5NUw0OS43MzUyIDQwLjg5ODRaTTU4Ljc0MjYgNDEuMTA2NkM1OC42ODg3IDQwLjgwODYgNTguNjcwNiA0MC40MzYgNTguNjcwNiA0MC4wNTU4VjM4LjQxNDFDNTguNjcwNiAzNy41MzU1IDU4LjM0NDQgMzYuNjIwOSA1Ny4wMDMyIDM2LjYyMDlDNTYuNDUwOSAzNi42MjA5IDU1LjkyNDIgMzYuNzc1IDU1LjU2MiAzNy4wMDg5TDU1Ljc0NDMgMzcuNTM1NUM1Ni4wNSAzNy4zMzUgNTYuNDc2NSAzNy4yMDkyIDU2Ljg4NSAzNy4yMDkyQzU3Ljc4MTUgMzcuMjA5MiA1Ny44ODE5IDM3Ljg2MTkgNTcuODgxOSAzOC4yMjRWMzguMzEzOUM1Ni4xODYxIDM4LjMwNjMgNTUuMjQzMyAzOC44ODY5IDU1LjI0MzMgMzkuOTQ1NEM1NS4yNDMzIDQwLjU4IDU1LjY5ODEgNDEuMjA2NyA1Ni41ODcgNDEuMjA2N0M1Ny4yMTEzIDQxLjIwNjcgNTcuNjgxNCA0MC44OTg1IDU3LjkyODEgNDAuNTU0Mkg1Ny45NTM3TDU4LjAxOCA0MS4xMDY2SDU4Ljc0MjZaTTU3Ljg5OTkgMzkuNjI5NEM1Ny44OTk5IDM5LjcxMTYgNTcuODgyIDM5LjgwMTQgNTcuODUzNiAzOS44ODM2QzU3LjcyNzcgNDAuMjUzNyA1Ny4zNjU2IDQwLjYxNTggNTYuNzk1MiA0MC42MTU4QzU2LjM4NjcgNDAuNjE1OCA1Ni4wNDI0IDQwLjM3MTggNTYuMDQyNCAzOS44NTUzQzU2LjA0MjQgMzkuMDA1MSA1Ny4wMjg5IDM4Ljg1MDggNTcuODk5OSAzOC44Njg5VjM5LjYyOTRaTTY1LjU4NDIgMzYuNzIxMUg2NC43ODc3VjM5LjQxMUM2NC43ODc3IDM5LjU1NzQgNjQuNzU5NSAzOS43MDEzIDY0LjcxNTcgMzkuODE5NUM2NC41NjkzIDQwLjE3NCA2NC4xOTk0IDQwLjU0NCA2My42NjI0IDQwLjU0NEM2Mi45MzggNDAuNTQ0IDYyLjY4MzYgMzkuOTgzOCA2Mi42ODM2IDM5LjE0OVYzNi43MjExSDYxLjg4NzFWMzkuMjg1MkM2MS44ODcxIDQwLjgyNjYgNjIuNzExOCA0MS4yMDY3IDYzLjQwMDMgNDEuMjA2N0M2NC4xNzg4IDQxLjIwNjcgNjQuNjQxMyA0MC43NDQ0IDY0Ljg1MTkgNDAuMzg5OEg2NC44Njk5TDY0LjkxMzYgNDEuMTA2N0g2NS42MjAxQzY1LjU5NDMgNDAuNzYyNSA2NS41ODQxIDQwLjM2NDIgNjUuNTg0MSAzOS45MDk1TDY1LjU4NDIgMzYuNzIxMVpNNjQuMTYwOSAzNC44MjUxTDYzLjM2NDQgMzYuMTIyNUg2My45MzQ4TDY1LjA0MjEgMzQuODI1MUg2NC4xNjA5Wk03MS44NTc5IDM0LjY3MDlWMzcuMjkxNEg3MS44NEM3MS42Mzk1IDM2LjkzNjkgNzEuMTg3NSAzNi42MjA5IDcwLjUxNjkgMzYuNjIwOUM2OS40NDU1IDM2LjYyMDkgNjguNTQxMyAzNy41MTc2IDY4LjU0OSAzOC45NzY3QzY4LjU0OSA0MC4zMTAxIDY5LjM2NiA0MS4yMDY3IDcwLjQyNDQgNDEuMjA2N0M3MS4xNDEyIDQxLjIwNjcgNzEuNjc1NiA0MC44MzQyIDcxLjkxOTcgNDAuMzQ2MUg3MS45Mzc3TDcxLjk3NjMgNDEuMTA2Nkg3Mi42OTA0QzcyLjY2NDggNDAuODA4NiA3Mi42NTQ1IDQwLjM2NDEgNzIuNjU0NSAzOS45NzM3VjM0LjY3MDlINzEuODU3OVpNNzEuODU3OSAzOS4yNjcxQzcxLjg1NzkgMzkuMzkzIDcxLjg0NzcgMzkuNTAzNSA3MS44MjIxIDM5LjYxMTNDNzEuNjc1NiA0MC4yMDk5IDcxLjE4NzUgNDAuNTYxOSA3MC42NTMxIDQwLjU2MTlDNjkuNzg5OCA0MC41NjE5IDY5LjM1NTYgMzkuODI5NyA2OS4zNTU2IDM4Ljk0MDlDNjkuMzU1NiAzNy45Njk3IDY5Ljg0NjMgMzcuMjQ1MSA3MC42NzEgMzcuMjQ1MUM3MS4yNjcgMzcuMjQ1MSA3MS43MDM3IDM3LjY2MTMgNzEuODIyMSAzOC4xNzAxQzcxLjg0NzcgMzguMjcwMyA3MS44NTc5IDM4LjQwNjQgNzEuODU3OSAzOC41MDY2VjM5LjI2NzFaTTc5LjQ2MjYgMzkuMDU5MUM3OS40NzA0IDM4Ljk3NjggNzkuNDg4MyAzOC44NTA5IDc5LjQ4ODMgMzguNjg2NEM3OS40ODgzIDM3Ljg3OTggNzkuMTA4IDM2LjYyMDkgNzcuNjc3IDM2LjYyMDlDNzYuMzk3NiAzNi42MjA5IDc1LjYxOTIgMzcuNjYxNCA3NS42MTkyIDM4Ljk4NDVDNzUuNjE5MiA0MC4zMTAyIDc2LjQyNTkgNDEuMTk2NiA3Ny43NzczIDQxLjE5NjZDNzguNDczNSA0MS4xOTY2IDc4Ljk1MzkgNDEuMDUyNiA3OS4yMzY1IDQwLjkyNDNMNzkuMTAwMyA0MC4zNTM4Qzc4Ljc5OTggNDAuNDgyNCA3OC40NTU1IDQwLjU4IDc3Ljg4NTIgNDAuNThDNzcuMDg4NyA0MC41OCA3Ni4zOTc2IDQwLjEzOCA3Ni4zNzk3IDM5LjA1OTFINzkuNDYyNlpNNzYuMzg5OCAzOC40ODYyQzc2LjQ1NDIgMzcuOTMzOSA3Ni44MDYxIDM3LjE5MTMgNzcuNjEyOSAzNy4xOTEzQzc4LjUwOTQgMzcuMTkxMyA3OC43Mjc4IDM3Ljk4MDEgNzguNzIgMzguNDg2Mkg3Ni4zODk4Wk04Ny4xMTA4IDQxLjEwNjdWMzYuNzIxMkg4Ni4zMTQ0VjQxLjEwNjdIODcuMTEwOFpNODYuNzEyNyAzNC45ODk1Qzg2LjQyMjMgMzQuOTg5NSA4Ni4yMTQxIDM1LjIwNTMgODYuMjE0MSAzNS40ODhDODYuMjE0MSAzNS43NjAyIDg2LjQxMiAzNS45NzYgODYuNjk0NiAzNS45NzZDODcuMDEwNiAzNS45NzYgODcuMjExMSAzNS43NjAyIDg3LjIwMDggMzUuNDg4Qzg3LjIwMDggMzUuMjA1NCA4Ny4wMTA2IDM0Ljk4OTUgODYuNzEyNyAzNC45ODk1Wk05MC4zOTQxIDQxLjEwNjdIOTEuMTkwNlYzOC40NjgxQzkxLjE5MDYgMzguMzMyIDkxLjIwODYgMzguMTk4MyA5MS4yNDQ3IDM4LjA5ODJDOTEuMzgwNyAzNy42NTM3IDkxLjc4OTIgMzcuMjgxMiA5Mi4zMTMyIDM3LjI4MTJDOTMuMDY2MSAzNy4yODEyIDkzLjMzMDcgMzcuODcyIDkzLjMzMDcgMzguNTc4N1Y0MS4xMDY3SDk0LjEyNzFWMzguNDg2MkM5NC4xMjcxIDM2Ljk4MzMgOTMuMTg0MyAzNi42MjEgOTIuNTc3OSAzNi42MjFDOTEuODUzNSAzNi42MjEgOTEuMzQ0OCAzNy4wMjY5IDkxLjEyNjQgMzcuNDQ1N0g5MS4xMDg0TDkxLjA2NDcgMzYuNzIxMkg5MC4zNTU3QzkwLjM4NCAzNy4wODM0IDkwLjM5NDEgMzcuNDUzNCA5MC4zOTQxIDM3LjkwODFMOTAuMzk0MSA0MS4xMDY3Wk05Ny41NjIgMzUuNjY3N1YzNi43MjEySDk2Ljg4MzdWMzcuMzI3NUg5Ny41NjJWMzkuNzE5M0M5Ny41NjIgNDAuMjM1NiA5Ny42NDQyIDQwLjYyNjIgOTcuODcwMyA0MC44NjI1Qzk4LjA2MDQgNDEuMDc4NCA5OC4zNjA5IDQxLjE5NjUgOTguNzMwOSA0MS4xOTY1Qzk5LjAzOTIgNDEuMTk2NSA5OS4yODMzIDQxLjE1MjggOTkuNDM3NCA0MS4wODg1TDk5LjQwMTQgNDAuNDg5OUM5OS4zMDEyIDQwLjUxODIgOTkuMTQ3MSA0MC41NDQgOTguOTM5IDQwLjU0NEM5OC40OTQ2IDQwLjU0NCA5OC4zNDA0IDQwLjIzNTYgOTguMzQwNCAzOS42OTM1VjM3LjMyNzVIOTkuNDgzOFYzNi43MjEySDk4LjM0MDRWMzUuNDU5N0w5Ny41NjIgMzUuNjY3N1pNMTA1LjgxMSAzOS4wNTkxQzEwNS44MTkgMzguOTc2OCAxMDUuODM3IDM4Ljg1MDkgMTA1LjgzNyAzOC42ODY0QzEwNS44MzcgMzcuODc5OCAxMDUuNDU2IDM2LjYyMDkgMTA0LjAyNiAzNi42MjA5QzEwMi43NDYgMzYuNjIwOSAxMDEuOTY4IDM3LjY2MTQgMTAxLjk2OCAzOC45ODQ1QzEwMS45NjggNDAuMzEwMiAxMDIuNzc0IDQxLjE5NjYgMTA0LjEyNiA0MS4xOTY2QzEwNC44MjIgNDEuMTk2NiAxMDUuMzAyIDQxLjA1MjYgMTA1LjU4NSA0MC45MjQzTDEwNS40NDkgNDAuMzUzOEMxMDUuMTQ4IDQwLjQ4MjQgMTA0LjgwNCA0MC41OCAxMDQuMjM0IDQwLjU4QzEwMy40MzcgNDAuNTggMTAyLjc0NiA0MC4xMzggMTAyLjcyOCAzOS4wNTkxSDEwNS44MTFaTTEwMi43MzggMzguNDg2MkMxMDIuODAzIDM3LjkzMzkgMTAzLjE1NSAzNy4xOTEzIDEwMy45NjEgMzcuMTkxM0MxMDQuODU4IDM3LjE5MTMgMTA1LjA3NiAzNy45ODAxIDEwNS4wNjkgMzguNDg2MkgxMDIuNzM4Wk0xMDguNzg0IDQxLjEwNjdIMTA5LjU4VjM0LjY3MUgxMDguNzg0VjQxLjEwNjdaTTExMy42NzggNDEuMTA2N1YzNi43MjEySDExMi44ODFWNDEuMTA2N0gxMTMuNjc4Wk0xMTMuMjggMzQuOTg5NUMxMTIuOTg5IDM0Ljk4OTUgMTEyLjc4MSAzNS4yMDUzIDExMi43ODEgMzUuNDg4QzExMi43ODEgMzUuNzYwMiAxMTIuOTc5IDM1Ljk3NiAxMTMuMjYxIDM1Ljk3NkMxMTMuNTc3IDM1Ljk3NiAxMTMuNzc4IDM1Ljc2MDIgMTEzLjc2OCAzNS40ODhDMTEzLjc2OCAzNS4yMDU0IDExMy41NzggMzQuOTg5NSAxMTMuMjggMzQuOTg5NVpNMTIwLjA0MSAzNi43MjEyTDEyMC4wMDUgMzcuMzgxNEgxMTkuOTg4QzExOS43OTcgMzcuMDE5MSAxMTkuMzc5IDM2LjYyMDkgMTE4LjYxOCAzNi42MjA5QzExNy42MTQgMzYuNjIwOSAxMTYuNjQzIDM3LjQ2MzcgMTE2LjY0MyAzOC45NDg2QzExNi42NDMgNDAuMTYzOCAxMTcuNDIxIDQxLjA4ODYgMTE4LjUxIDQxLjA4ODZDMTE5LjE4OSA0MS4wODg2IDExOS42NjEgNDAuNzYyNSAxMTkuOTA1IDQwLjM1MzhIMTE5LjkyM1Y0MC44NDQ2QzExOS45MjMgNDEuOTQ5MyAxMTkuMzI1IDQyLjM3NTcgMTE4LjUxIDQyLjM3NTdDMTE3Ljk2NiA0Mi4zNzU3IDExNy41MTMgNDIuMjExNCAxMTcuMjIzIDQyLjAzMTVMMTE3LjAyMyA0Mi42Mzc4QzExNy4zNzcgNDIuODc0MSAxMTcuOTU4IDQzIDExOC40ODIgNDNDMTE5LjAzNCA0MyAxMTkuNjUxIDQyLjg3NDEgMTIwLjA3OCA0Mi40NzZDMTIwLjUwNCA0Mi4wOTU3IDEyMC43MDQgNDEuNDc5MiAxMjAuNzA0IDQwLjQ3MjFWMzcuOTI2MUMxMjAuNzA0IDM3LjM5MTcgMTIwLjcyMiAzNy4wMzcxIDEyMC43NCAzNi43MjExTDEyMC4wNDEgMzYuNzIxMlpNMTE5LjkxNiAzOS4yMzg5QzExOS45MTYgMzkuMzc1MSAxMTkuODk4IDM5LjUyOTIgMTE5Ljg1MSAzOS42NjUzQzExOS42NzkgNDAuMTc0IDExOS4yMzUgNDAuNDgyNCAxMTguNzQ3IDQwLjQ4MjRDMTE3Ljg4MyA0MC40ODI0IDExNy40NDkgMzkuNzY1NSAxMTcuNDQ5IDM4LjkwNDlDMTE3LjQ0OSAzNy44OTAxIDExNy45OTQgMzcuMjQ1MiAxMTguNzU0IDM3LjI0NTJDMTE5LjMzNSAzNy4yNDUyIDExOS43MjUgMzcuNjI1NCAxMTkuODY5IDM4LjA4NzlDMTE5LjkwNSAzOC4xOTgzIDExOS45MTYgMzguMzEzOSAxMTkuOTE2IDM4LjQ1MDFWMzkuMjM4OVpNMTI3LjUxIDM5LjA1OTFDMTI3LjUxOCAzOC45NzY4IDEyNy41MzYgMzguODUwOSAxMjcuNTM2IDM4LjY4NjRDMTI3LjUzNiAzNy44Nzk4IDEyNy4xNTUgMzYuNjIwOSAxMjUuNzI0IDM2LjYyMDlDMTI0LjQ0NSAzNi42MjA5IDEyMy42NjcgMzcuNjYxNCAxMjMuNjY3IDM4Ljk4NDVDMTIzLjY2NyA0MC4zMTAyIDEyNC40NzMgNDEuMTk2NiAxMjUuODI1IDQxLjE5NjZDMTI2LjUyMSA0MS4xOTY2IDEyNy4wMDEgNDEuMDUyNiAxMjcuMjg0IDQwLjkyNDNMMTI3LjE0OCA0MC4zNTM4QzEyNi44NDcgNDAuNDgyNCAxMjYuNTAzIDQwLjU4IDEyNS45MzMgNDAuNThDMTI1LjEzNiA0MC41OCAxMjQuNDQ1IDQwLjEzOCAxMjQuNDI3IDM5LjA1OTFIMTI3LjUxWk0xMjQuNDM3IDM4LjQ4NjJDMTI0LjUwMSAzNy45MzM5IDEyNC44NTMgMzcuMTkxMyAxMjUuNjYgMzcuMTkxM0MxMjYuNTU3IDM3LjE5MTMgMTI2Ljc3NSAzNy45ODAxIDEyNi43NjcgMzguNDg2MkgxMjQuNDM3Wk0xMzAuNDgyIDQxLjEwNjdIMTMxLjI3OVYzOC40NjgxQzEzMS4yNzkgMzguMzMyIDEzMS4yOTcgMzguMTk4MyAxMzEuMzMzIDM4LjA5ODJDMTMxLjQ2OSAzNy42NTM3IDEzMS44NzcgMzcuMjgxMiAxMzIuNDAxIDM3LjI4MTJDMTMzLjE1NCAzNy4yODEyIDEzMy40MTkgMzcuODcyIDEzMy40MTkgMzguNTc4N1Y0MS4xMDY3SDEzNC4yMTVWMzguNDg2MkMxMzQuMjE1IDM2Ljk4MzMgMTMzLjI3MyAzNi42MjEgMTMyLjY2NiAzNi42MjFDMTMxLjk0MiAzNi42MjEgMTMxLjQzMyAzNy4wMjY5IDEzMS4yMTUgMzcuNDQ1N0gxMzEuMTk3TDEzMS4xNTMgMzYuNzIxMkgxMzAuNDQ0QzEzMC40NzIgMzcuMDgzNCAxMzAuNDgyIDM3LjQ1MzQgMTMwLjQ4MiAzNy45MDgxTDEzMC40ODIgNDEuMTA2N1pNMTM3LjY1IDM1LjY2NzdWMzYuNzIxMkgxMzYuOTcyVjM3LjMyNzVIMTM3LjY1VjM5LjcxOTNDMTM3LjY1IDQwLjIzNTYgMTM3LjczMiA0MC42MjYyIDEzNy45NTggNDAuODYyNUMxMzguMTQ4IDQxLjA3ODQgMTM4LjQ0OSA0MS4xOTY1IDEzOC44MTkgNDEuMTk2NUMxMzkuMTI3IDQxLjE5NjUgMTM5LjM3MSA0MS4xNTI4IDEzOS41MjYgNDEuMDg4NUwxMzkuNDkgNDAuNDg5OUMxMzkuMzg5IDQwLjUxODIgMTM5LjIzNSA0MC41NDQgMTM5LjAyNyA0MC41NDRDMTM4LjU4MyA0MC41NDQgMTM4LjQyOSA0MC4yMzU2IDEzOC40MjkgMzkuNjkzNVYzNy4zMjc1SDEzOS41NzJWMzYuNzIxMkgxMzguNDI5VjM1LjQ1OTdMMTM3LjY1IDM1LjY2NzdaTTE0NS44OTggMzkuMDU5MUMxNDUuOTA2IDM4Ljk3NjggMTQ1LjkyNCAzOC44NTA5IDE0NS45MjQgMzguNjg2NEMxNDUuOTI0IDM3Ljg3OTggMTQ1LjU0NCAzNi42MjA5IDE0NC4xMTMgMzYuNjIwOUMxNDIuODMzIDM2LjYyMDkgMTQyLjA1NSAzNy42NjE0IDE0Mi4wNTUgMzguOTg0NUMxNDIuMDU1IDQwLjMxMDIgMTQyLjg2MiA0MS4xOTY2IDE0NC4yMTMgNDEuMTk2NkMxNDQuOTA5IDQxLjE5NjYgMTQ1LjM5IDQxLjA1MjYgMTQ1LjY3MiA0MC45MjQzTDE0NS41MzYgNDAuMzUzOEMxNDUuMjM2IDQwLjQ4MjQgMTQ0Ljg5MSA0MC41OCAxNDQuMzIxIDQwLjU4QzE0My41MjUgNDAuNTggMTQyLjgzMyA0MC4xMzggMTQyLjgxNSAzOS4wNTkxSDE0NS44OThaTTE0Mi44MjYgMzguNDg2MkMxNDIuODkgMzcuOTMzOSAxNDMuMjQyIDM3LjE5MTMgMTQ0LjA0OSAzNy4xOTEzQzE0NC45NDUgMzcuMTkxMyAxNDUuMTY0IDM3Ljk4MDEgMTQ1LjE1NiAzOC40ODYySDE0Mi44MjZaIiBmaWxsPSJibGFjayIvPgo8cGF0aCBkPSJNMTQ1LjI0MiAyNy4yOTc3SDE0MS44M0MxNDEuMjAyIDI3LjI5NzcgMTQwLjY5MyAyNi43ODgzIDE0MC42OTMgMjYuMTYwMkMxNDAuNjkzIDI1LjUzMjEgMTQxLjIwMiAyNS4wMjI5IDE0MS44MyAyNS4wMjI5SDE0NS4yNDJWMjcuMjk3N1pNMTQ1LjI0MiAxMy42NDkxSDEzNy4yOFYxOC4xOTg2SDE0NC4xMDVDMTQ0LjczMyAxOC4xOTg2IDE0NS4yNDIgMTguNzA3OCAxNDUuMjQyIDE5LjMzNlYyMC40NzM0SDE0MC42OTNDMTM4LjE4IDIwLjQ3MzQgMTM2LjE0MyAyMi41MTAzIDEzNi4xNDMgMjUuMDIzVjI3LjI5NzhDMTM2LjE0MyAyOS44MTA0IDEzOC4xOCAzMS44NDczIDE0MC42OTMgMzEuODQ3M0gxNDkuNzkyVjE4LjE5ODZDMTQ5Ljc5MiAxNS42ODYgMTQ3Ljc1NSAxMy42NDkxIDE0NS4yNDIgMTMuNjQ5MVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik0xMTEuMTIgMjAuNDcyOUMxMTEuMTIgMjQuMjQyIDEwOC4wNjUgMjcuMjk3MyAxMDQuMjk2IDI3LjI5NzNWNi44MjQ0NEg5OS43NDY1VjMxLjg0NjdIMTA0LjI5NkMxMTAuNTc4IDMxLjg0NjcgMTE1LjY3IDI2Ljc1NDUgMTE1LjY3IDIwLjQ3MjlWMEgxMTEuMTJWMjAuNDcyOVoiIGZpbGw9ImJsYWNrIi8+CjxwYXRoIGQ9Ik05Mi45MjIzIDI2LjE1OTdDOTIuOTIyMyAyNi43ODc5IDkyLjQxMjkgMjcuMjk3MiA5MS43ODQ4IDI3LjI5NzJIODkuNTFDODguODgxOCAyNy4yOTcyIDg4LjM3MjYgMjYuNzg3OSA4OC4zNzI2IDI2LjE1OTdWMTkuMzM1NEM4OC4zNzI2IDE4LjcwNzQgODguODgxOCAxOC4xOTgyIDg5LjUxIDE4LjE5ODJIOTEuNzg0OEM5Mi40MTI5IDE4LjE5ODIgOTIuOTIyMyAxOC43MDc1IDkyLjkyMjMgMTkuMzM1NFYyNi4xNTk3Wk05Mi45MjIzIDEzLjY0ODVIODguMzcyNkM4NS44NiAxMy42NDg1IDgzLjgyMzEgMTUuNjg1MyA4My44MjMxIDE4LjE5ODJWMjcuMjk3MkM4My44MjMxIDI5LjgwOTggODUuODYgMzEuODQ2NyA4OC4zNzI2IDMxLjg0NjdIOTIuOTIyM0M5NS40MzQ5IDMxLjg0NjcgOTcuNDcxOCAyOS44MDk4IDk3LjQ3MTggMjcuMjk3MlYxOC4xOTgyQzk3LjQ3MTggMTUuNjg1MyA5NS40MzQ5IDEzLjY0ODUgOTIuOTIyMyAxMy42NDg1WiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTExNy45NDUgMzEuODQ3MUgxMjIuNDk0VjEzLjY0OTFIMTE3Ljk0NVYzMS44NDcxWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTExNy45NDUgMTEuMzc0MUgxMjIuNDk0VjYuODI0NzNIMTE3Ljk0NVYxMS4zNzQxWiIgZmlsbD0iYmxhY2siLz4KPHBhdGggZD0iTTEyOS4zNzcgNi44MjQzMkgxMjQuNzY5VjI1LjAyMjZDMTI0Ljc2OSAyOC43OTE2IDEyNy44MjQgMzEuODQ2OSAxMzEuNTkzIDMxLjg0NjlIMTMzLjg2OFYyNy4yNTA1SDEzMS42NTJDMTMwLjM5NSAyNy4yNTA1IDEyOS4zNzcgMjYuMjMyMiAxMjkuMzc3IDI0Ljk3NTdWMTguMTk4MkgxMzMuODY4VjEzLjY0ODZIMTI5LjM3N0wxMjkuMzc3IDYuODI0MzJaIiBmaWxsPSJibGFjayIvPgo8L3N2Zz4K" />
          ${qrcodeBase64 ? `<img class="qrcode" src="${qrcodeBase64}" />` : ''}
        </div>
        <p>Leia o QR Code, baixe o App Deovita e agende suas consultas.</p>
        <div style="height: 30mm;">.</div>
      </div>
    </body>
    </html>
  `;
}

function setupTestPrint() {
  const printTest = document.getElementById('printTest');
  if (!printTest) {
    console.warn('[setupTestPrint] Botão #printTest não existe nesta tela. Ignorando...');
    return;
  }

  printTest.addEventListener('click', () => {
    const content = generateTicketHTML({
      code: 'A001',
      type: 'NORMAL',
      origin: 'Recepção'
    });

    window.printerAPI.print(content);
  });
}

document.addEventListener('DOMContentLoaded', () => {
  setupPrinters();
  setupTestPrint();
  const save = document.getElementById('savePrinterButton');

  if(save) {
    save.addEventListener('click', saveDefaultPrinter);
  }
});
